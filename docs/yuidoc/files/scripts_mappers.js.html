<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>scripts&#x2F;mappers.js - The Lu Component API</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http:&#x2F;&#x2F;use.lu&#x2F;images&#x2F;logo.png" title="The Lu Component API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.3.x</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/aboveDecorator.html">aboveDecorator</a></li>
            
                <li><a href="..&#x2F;classes/Abstract.html">Abstract</a></li>
            
                <li><a href="..&#x2F;classes/belowDecorator.html">belowDecorator</a></li>
            
                <li><a href="..&#x2F;classes/Button.html">Button</a></li>
            
                <li><a href="..&#x2F;classes/Carousel.html">Carousel</a></li>
            
                <li><a href="..&#x2F;classes/Container.html">Container</a></li>
            
                <li><a href="..&#x2F;classes/DefaultDecorator.html">DefaultDecorator</a></li>
            
                <li><a href="..&#x2F;classes/Dropdown.html">Dropdown</a></li>
            
                <li><a href="..&#x2F;classes/firstDecorator.html">firstDecorator</a></li>
            
                <li><a href="..&#x2F;classes/FormElement.html">FormElement</a></li>
            
                <li><a href="..&#x2F;classes/genericStateDecorator.html">genericStateDecorator</a></li>
            
                <li><a href="..&#x2F;classes/lastDecorator.html">lastDecorator</a></li>
            
                <li><a href="..&#x2F;classes/leftDecorator.html">leftDecorator</a></li>
            
                <li><a href="..&#x2F;classes/List.html">List</a></li>
            
                <li><a href="..&#x2F;classes/loadDecorator.html">loadDecorator</a></li>
            
                <li><a href="..&#x2F;classes/Lu.html">Lu</a></li>
            
                <li><a href="..&#x2F;classes/Mapper.html">Mapper</a></li>
            
                <li><a href="..&#x2F;classes/nextDecorator.html">nextDecorator</a></li>
            
                <li><a href="..&#x2F;classes/pauseDecorator.html">pauseDecorator</a></li>
            
                <li><a href="..&#x2F;classes/Placeholder.html">Placeholder</a></li>
            
                <li><a href="..&#x2F;classes/playDecorator.html">playDecorator</a></li>
            
                <li><a href="..&#x2F;classes/previousDecorator.html">previousDecorator</a></li>
            
                <li><a href="..&#x2F;classes/rightDecorator.html">rightDecorator</a></li>
            
                <li><a href="..&#x2F;classes/selectDecorator.html">selectDecorator</a></li>
            
                <li><a href="..&#x2F;classes/stateDecorator.html">stateDecorator</a></li>
            
                <li><a href="..&#x2F;classes/Switch.html">Switch</a></li>
            
                <li><a href="..&#x2F;classes/Tip.html">Tip</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/Button.html">Button</a></li>
            
                <li><a href="..&#x2F;modules/Lu.html">Lu</a></li>
            
                <li><a href="..&#x2F;modules/Tip.html">Tip</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: scripts&#x2F;mappers.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
( function(){

  &#x2F;**
   * Mappers are used to store a scope of a DOM tree
   * to map and a registry of mappers to execute
   * @class Mapper
   * @constructor
   *&#x2F;
  Lu.Mapper = function(){
    var scope = window.LU_CONFIG.scope || document;
    this.$scope = undefined;
    this.maps = [];
    this.setScope( scope );
  };

  &#x2F;**
   * Sets the scope to use when mapping components to nodes
   * @public
   * @method setScoped
   * @param {*} scope This can be an HTML Element,
   * an array of elements, a selector string or a jquery object
   * @return this
   *&#x2F;
  Lu.Mapper.prototype.setScope = function( scope ){
    var $scope;

    function filter( item, index ){
      var lu = item.getAttribute( &#x27;data-lu&#x27; );
      return ( lu !== null &amp;&amp; lu !== &#x27;&#x27; );
    }

    if( scope instanceof $ ){
      $scope = scope.find( &#x27;[data-lu]&#x27; ).add( _.filter( scope, filter ) );
    } else if( scope.getElementsByTagName ){
      $scope = $( _.filter( scope.getElementsByTagName( &#x27;*&#x27; ), filter ) );
    } else {
      $scope = $( scope );
      $scope = $scope.find( &#x27;[data-lu]&#x27; ).add( _.filter( $scope, filter ) );
    }

    this.$scope = $scope;
    return this;
  };

  &#x2F;**
   * Gets a jquery object containing all Lu decorated nodes
   * @public
   * @method setScoped
   * @return a jquery object
   *&#x2F;
  Lu.Mapper.prototype.getScope = function(){
    return this.$scope;
  };

  &#x2F;**
   * Registers a mapper to be executed later
   * @public
   * @method register
   * @param {Function} map A function mapper to be called
   * @return this
   *&#x2F;
  Lu.Mapper.prototype.register = function( map ){
    this.maps.unshift( map );
    return this;
  };

  &#x2F;**
   * Executes all registered maps
   * @public
   * @method execute
   * @return this
   *&#x2F;
  Lu.Mapper.prototype.execute = function(){
    _.each( this.maps, function( item, index ){
      item.call();
    } );
  };

  &#x2F;&#x2F;Create a new Mapper to contain default mappings for Lu.
  var Mapper = Lu.DefaultMapper = new Lu.Mapper();

  &#x2F;&#x2F;Generic Mappers
  _.each( [&#x27;Switch&#x27;, &#x27;List&#x27;, &#x27;Carousel&#x27;, &#x27;Container&#x27;, &#x27;Button&#x27;], function( id, index ){
    Mapper.register( function(){
      Lu.map( _.filter( Mapper.$scope, function( item, index ){
        return ( item.getAttribute( &#x27;data-lu&#x27; ).indexOf( id ) &gt; -1 );
      } ), id );
    } );
  } );

  &#x2F;&#x2F; Coalesce the Viewport decorator for List&#x2F;Carousel into one mapper function.
  Mapper.register( function () {
    var components = [&#x27;List&#x27;, &#x27;Carousel&#x27;];
    var decorator = &#x27;Viewport&#x27;;
    _.each(components, function (component) {
      var key = component + &#x27;:&#x27; + decorator;
      Lu.map(_.filter(Mapper.$scope, function (item) {
        return ( item.getAttribute(&#x27;data-lu&#x27;).indexOf(key) &gt; -1 );
      }), component, function () {
        this.hasDependencies = true;
        &#x2F;&#x2F; Default configs
        this.settings.viewport = {
          mode:&#x27;sliding&#x27;,
          pageSize:5,
          threshold:0.8,
          previewSize:0.25
        };
      });
    });
  });

  &#x2F;&#x2F; Coalesce the buttons into one mapper function, because we care about performance,
  &#x2F;&#x2F; saving bytes, and abhor redundancy.
  _.each( [&#x27;select&#x27;, &#x27;first&#x27;, &#x27;last&#x27;, &#x27;next&#x27;, &#x27;previous&#x27;, &#x27;load&#x27;, &#x27;play&#x27;, &#x27;pause&#x27;, &#x27;state&#x27;], function( action ) {

    Mapper.register( function(){
      var key = &#x27;Button:&#x27; + action.charAt( 0 ).toUpperCase() + action.substring( 1 );
      Lu.map( _.filter( Mapper.$scope, function( item ){
        return ( item.getAttribute( &#x27;data-lu&#x27; ).indexOf( key ) &gt; -1 );
      } ), &#x27;Button&#x27;, function(){
        this.settings.action = action;
        this.key = key;
        this.hasDependencies = true;
      } );
    } );
  } );


  Mapper.register( function(){
    var key = &#x27;Tip&#x27;;
    Lu.map( _.filter( Mapper.$scope, function( item ){
      return ( _.indexOf( item.getAttribute( &#x27;data-lu&#x27; ).split( &#x27; &#x27; ), key ) &gt; -1 );
    } ), &#x27;Tip&#x27;, function(){
      this.settings.placement = &#x27;Right&#x27;;
      this.key = key;
      this.hasDependencies = true;
    } );
  } );

  _.each( [&#x27;Above&#x27;, &#x27;Below&#x27;, &#x27;Left&#x27;, &#x27;Right&#x27;], function( placement ) {
    Mapper.register( function(){
      var key = &#x27;Tip:&#x27; + placement;
      Lu.map( _.filter( Mapper.$scope, function( item ){
        return ( _.indexOf( item.getAttribute( &#x27;data-lu&#x27; ).split( &#x27; &#x27; ), key ) &gt; -1 );
      } ), &#x27;Tip&#x27;, function(){
        this.settings.placement = placement;
        this.key = key;
        this.hasDependencies = true;
      } );
    } );
  } );

  &#x2F;&#x2F;Placeholder
  Mapper.register( function(){
    Lu.map( _.filter( Mapper.$scope, function( item, index ){
      return ( item.getAttribute( &#x27;data-lu&#x27; ).indexOf( &#x27;Placeholder&#x27; ) &gt; -1 &amp;&amp;
             ( item.nodeName === &#x27;INPUT&#x27; || item.nodeName === &#x27;TEXTAREA&#x27; ) &amp;&amp;
             item.getAttribute( &#x27;placeholder&#x27; ) );
    } ), &#x27;Placeholder&#x27; );
  } );

  &#x2F;&#x2F;Dropdown
  Mapper.register( function(){
    Lu.map( _.filter( Mapper.$scope, function( item, index ){
      return ( item.getAttribute( &#x27;data-lu&#x27; ).indexOf( &#x27;Dropdown&#x27; ) &gt; -1 );
    } ), &#x27;Dropdown&#x27; );
  } );

  &#x2F;&#x2F;Execute Default Mappers
  Mapper.execute();

}() );

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
